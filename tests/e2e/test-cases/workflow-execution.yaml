# Test Suite: Workflow Execution
# Validates workflow loading and execution commands

test_suite: 'Workflow Execution Tests'
description: 'Validate BMAD workflow loading with asterisk (*) prefix'

config:
  llm_model: 'gpt-4.1'
  temperature: 0.1
  timeout: 30000
  judge_model: 'gpt-4.1'
  judge_threshold: 0.7

tests:
  - id: 'workflow-001'
    name: 'Execute party-mode workflow'
    prompt: |
      You have access to a BMAD MCP tool.

      User request: "Start a brainstorming party mode session"

      Call bmad with command "*party-mode" to execute the party-mode workflow.

    expectations:
      - type: 'contains'
        value: 'party'
        case_sensitive: false
        description: 'Should reference party-mode'

      - type: 'response_length'
        min: 50
        max: 10000
        description: 'Should provide workflow content'

      - type: 'not_contains'
        value: 'not found'
        case_sensitive: false
        description: 'Should find the workflow'

  - id: 'workflow-002'
    name: 'Execute analysis workflow'
    prompt: |
      You have access to a BMAD MCP tool.

      User says: "Run the analysis workflow"

      Call bmad with command "*analysis"

    expectations:
      - type: 'contains'
        value: 'analysis'
        case_sensitive: false
        description: 'Should reference analysis workflow'

      - type: 'not_contains'
        value: 'error'
        case_sensitive: false
        description: 'Should not error'

  - id: 'workflow-003'
    name: 'Execute dev-story workflow'
    prompt: |
      You have access to a BMAD MCP tool.

      User request: "Execute the dev story workflow"

      Call bmad with command "*dev-story"

    expectations:
      - type: 'response_length'
        min: 50
        max: 10000
        description: 'Should load workflow'

  - id: 'workflow-004'
    name: 'Asterisk prefix is required for workflows'
    prompt: |
      You have access to a BMAD MCP tool.

      User mistakenly says: "Load party-mode" (without asterisk)

      Call bmad with command "party-mode" (missing asterisk - this should fail or suggest correction)

    expectations:
      - type: 'response_length'
        min: 10
        max: 5000
        description: 'Should provide some response'

  - id: 'workflow-005'
    name: 'Workflow with module prefix'
    prompt: |
      You have access to a BMAD MCP tool.

      User says: "Execute core/party-mode workflow"

      Call bmad with command "*core/party-mode" (qualified workflow name)

    expectations:
      - type: 'response_length'
        min: 50
        max: 10000
        description: 'Should handle qualified workflow names'

  - id: 'workflow-006'
    name: 'Execute retrospective workflow'
    prompt: |
      You have access to a BMAD MCP tool.

      User request: "Run a sprint retrospective"

      Call bmad with command "*retrospective"

    expectations:
      - type: 'contains'
        value: 'retrospective'
        case_sensitive: false
        description: 'Should reference retrospective'

  - id: 'workflow-007'
    name: 'Execute brainstorm workflow'
    prompt: |
      You have access to a BMAD MCP tool.

      User says: "Start brainstorming session"

      Call bmad with command "*brainstorm-project"

    expectations:
      - type: 'contains'
        value: 'brainstorm'
        case_sensitive: false
        description: 'Should reference brainstorming'

  - id: 'workflow-008'
    name: 'Execute init workflow'
    prompt: |
      You have access to a BMAD MCP tool.

      User request: "Initialize a new BMAD project"

      Call bmad with command "*init"

    expectations:
      - type: 'response_length'
        min: 50
        max: 5000
        description: 'Should provide init information'

      - type: 'not_contains'
        value: 'undefined'
        case_sensitive: false
        description: 'Should not have undefined values'
