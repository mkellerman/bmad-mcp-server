# Test Suite: Error Handling
# Validates graceful error handling for invalid commands

test_suite: "Error Handling Tests"
description: "Validate error handling for invalid BMAD commands"

config:
  llm_model: "gpt-4.1"
  temperature: 0.1
  timeout: 20000
  judge_model: "gpt-4.1"
  judge_threshold: 0.7

tests:
  - id: "error-001"
    name: "Invalid agent name"
    prompt: |
      User: "Load the nonexistent-agent from BMAD"
      
      Call bmad tool with command "nonexistent-agent"
    
    expectations:
      - type: "contains"
        value: "not found"
        case_sensitive: false
        description: "Should indicate agent not found"
      
      # TODO: LLM Judge validation - Work in Progress
      # - type: "llm_judge"
      #   criteria: |
      #     The response should:
      #     1. Clearly indicate the agent doesn't exist
      #     2. Provide helpful suggestions (list available agents, fix typo, etc.)
      #     3. Not crash or return a stack trace
      #     4. Maintain a professional tone
      #   threshold: 0.7

  - id: "error-002"
    name: "Malformed command"
    prompt: |
      User provides: "bmad do something random"
      
      Call bmad with command "do something random"
    
    expectations:
      - type: "not_contains"
        value: "stack trace"
        case_sensitive: false
      
      # TODO: LLM Judge validation - Work in Progress
      # - type: "llm_judge"
      #   criteria: |
      #     Check if the error response:
      #     1. Handles the invalid command gracefully
      #     2. Suggests correct command format
      #     3. Doesn't expose internal errors
      #   threshold: 0.65

  - id: "error-003"
    name: "Empty command"
    prompt: |
      User accidentally sends empty command.
      
      Call bmad with command ""
    
    expectations:
      - type: "response_length"
        min: 50
        max: 2000
        description: "Should provide some error feedback"
      
      # TODO: LLM Judge validation - Work in Progress
      # - type: "llm_judge"
      #   criteria: |
      #     The response should:
      #     1. Handle empty command gracefully
      #     2. Provide usage instructions
      #     3. Not throw an unhandled exception
      #   threshold: 0.6
